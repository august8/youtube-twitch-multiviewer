# CLAUDE.md

## 目的

このドキュメントは、開発プロジェクトにおけるClaude（AI Assistant）の動作原則とルールを定義します。
本ドキュメントはプロジェクト開発における最優先のルールとして機能します。

## ツール使用規則

### AskUserQuestionTool

以下の状況で使用します：
- **曖昧さがある場合**: 指示や要件に複数の解釈が可能な場合
- **複数の選択肢がある場合**: 実装方法やアプローチに複数の選択肢がある場合
- **重要な決定前**: システムに大きな影響を与える決定を行う前

**記録内容**:
- 選択した選択肢とその理由
- 選択しなかった選択肢とその理由
- これらの決定は `docs/DECISIONS.md` に記録する
- 記録方法の詳細は `rules/DECISIONS_GUIDE.md` を参照

これにより、意思決定の履歴とコンテキストが蓄積され、後から検索・参照できます。

### claude-code（コーディング連携）

**コミュニケーション**:
- 指示、説明、質問: 日本語
- エラーの説明と対応策: 日本語

**コード関連**:
- コード本体: 英語（変数名、関数名、コメント）
- エラーメッセージ: 英語（原文のまま）
- コミットメッセージ: `rules/COMMIT.md` の規約に従う

## ファイル参照方法

プロジェクト情報とルールは、それぞれ以下のディレクトリに格納されています。

### プロジェクト情報（編集可能）

`docs/` ディレクトリ配下：
- **docs/PROJECT.md**: システム概要、技術スタック、アーキテクチャ
- **docs/REQUIREMENTS.md**: 機能要件、仕様
- **docs/DECISIONS.md**: 技術的決定の記録（実際の記録）
- **docs/notes/**: 改修案、アイデア、メモ、将来やりたいこと

これらのファイルは開発中に必要に応じて更新できます。

### notes/ディレクトリの使い方

`docs/notes/` には改修案、アイデア、メモ、将来やりたいことなどを保存します。

**保存方針**:
- 既存ファイルと関連がありそうな場合は、ユーザーに確認してから追記
- 明らかに独立したトピックは新規作成
- トピック名でファイルを命名（例: `ui-improvements.md`, `performance.md`）

**確認の例**:
「この改修案は既存の `ui-improvements.md` に関連がありそうです。このファイルに追記しますか？それとも新規ファイルを作成しますか？」

### ルール・ガイド（読み取り専用）

`rules/` ディレクトリ配下：
- **rules/DECISIONS_GUIDE.md**: 決定記録の方法とタイミング
- **rules/COMMIT.md**: コミットメッセージ規約

これらは参照のみで、編集しないでください。

### 参照タイミング

- プロジェクト開始時
- 要件や仕様の確認が必要な時
- 技術選定や設計判断を行う時

## 制約事項

以下のルールを遵守してください：

### ファイル操作

- `CLAUDE.md` は直接編集禁止
- `rules/` 配下のファイルは読み取り専用（編集不可）
- `docs/` 配下のファイルは必要に応じて更新可能
- `src/` 配下はソースコード格納場所（自由に編集可能）

### 実行前の確認

以下の操作は実行前にユーザーに確認を求める：
- 破壊的操作（ファイル削除、データベース変更等）
- 複数ファイルの一括操作
- 本番環境への変更

### 段階的実行

- 大きな変更は小さなステップに分割する
- 各ステップで動作確認を行う
- ロールバック可能な状態を保つ

## Git運用

### コミットメッセージ規約

コミットメッセージの形式については `rules/COMMIT.md` を参照してください。

### Git操作の方針

**claude-codeの動作**:
- コミットやプッシュは**自動実行しない**
- 変更完了時にコミットメッセージ案を提示する
- ユーザーが内容を確認してから手動で実行

**推奨フロー**:
1. claude-codeが変更を完了
2. 変更内容とコミットメッセージ案を提示
3. ユーザーが内容を確認（`git diff`等）
4. ユーザーが手動でコミット・プッシュ

**理由**:
- 誤った変更のプッシュを防止
- コミット履歴を意図的に管理
- 変更内容を必ず確認する機会を確保

## バージョン管理

このCLAUDE.mdはgitで管理され、プロジェクトの開発フローの基盤となります。
重要な更新を行う際は、変更内容と理由を明確にしてコミットしてください。

---

**最終更新**: 2026-01-10
